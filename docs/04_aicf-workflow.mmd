%% Checkpoint Orchestrator Workflow
%% How the logic agent orchestrator processes conversation checkpoints with zero API costs

graph TB
    Start([Long conversation session<br/>5-16 hours, 200+ messages]) --> Trigger{Every 50 messages<br/>or context window<br/>approaching limit?}

    Trigger -->|No| Continue[Continue conversation<br/>Building features,<br/>making decisions]
    Continue --> Start
    
    Trigger -->|Yes| Checkpoint[Run: aic checkpoint --demo<br/>or automatic trigger]

    Checkpoint --> DataDump[Create checkpoint dump:<br/>â€¢ Session ID + number<br/>â€¢ Message array<br/>â€¢ Timestamps<br/>â€¢ Token count]

    DataDump --> Orchestrator[Checkpoint Orchestrator<br/>Initialize 6 logic agents]

    Orchestrator --> Parallel[ðŸ¤– Parallel Agent Processing<br/>Zero API costs, 10ms execution]

    Parallel --> Agent1[ConversationParserAgent<br/>Extract conversation flow<br/>@FLOW section]
    Parallel --> Agent2[DecisionExtractorAgent<br/>Find key decisions<br/>@DECISIONS section]
    Parallel --> Agent3[InsightAnalyzerAgent<br/>Capture insights<br/>@INSIGHTS section]
    Parallel --> Agent4[StateTrackerAgent<br/>Monitor project state<br/>@STATE section]
    Parallel --> Agent5[FileWriterAgent<br/>Output dual formats<br/>AICF + Markdown]
    Parallel --> Agent6[MemoryDropOffAgent<br/>Apply decay strategy<br/>Optimize storage]

    Agent1 --> Combine[Combine Results<br/>Structured data ready]
    Agent2 --> Combine
    Agent3 --> Combine
    Agent4 --> Combine
    Agent5 --> Combine
    Agent6 --> Combine

    Combine --> WriteFiles[Write Files:<br/>â€¢ .aicf/conversations.aicf<br/>â€¢ .ai/conversation-log.md<br/>â€¢ .ai/technical-decisions.md<br/>â€¢ .ai/next-steps.md]

    WriteFiles --> MemoryDecay[Apply Memory Decay<br/>if file > 1MB:<br/>Recent: Full detail<br/>Medium: Key points<br/>Old: Summaries<br/>Archived: Critical only]

    MemoryDecay --> NewSession[Start new chat session<br/>Say: Read .aicf/ and continue]

    NewSession --> AIReads[AI reads optimized files:<br/>âœ… 85% token reduction<br/>âœ… 100% information preservation<br/>âœ… Instant parsing<br/>âœ… Zero context loss]

    AIReads --> FullContext[New AI has complete context:<br/>âœ… All conversation flow<br/>âœ… All decisions + reasoning<br/>âœ… All insights + breakthroughs<br/>âœ… Current project state<br/>âœ… Task status + blockers]

    FullContext --> Seamless[Continue seamlessly<br/>No re-explaining needed<br/>AI knows everything]

    Seamless --> Benefits[Logic Agent Benefits:<br/>âœ… Zero API costs<br/>âœ… 10ms processing time<br/>âœ… 100% information preservation<br/>âœ… Parallel execution<br/>âœ… Automatic memory decay<br/>âœ… Works with all AIs]

    style Start fill:#e1f5ff,stroke:#0288d1,stroke-width:3px
    style Trigger fill:#ffe6e6,stroke:#f44336,stroke-width:2px
    style Continue fill:#fff4e6,stroke:#ff9800,stroke-width:2px
    style Checkpoint fill:#e1f5ff,stroke:#0288d1,stroke-width:3px
    style DataDump fill:#fff4e6,stroke:#ff9800,stroke-width:2px
    style Orchestrator fill:#f3e5f5,stroke:#9c27b0,stroke-width:3px
    style Parallel fill:#e1bee7,stroke:#8e24aa,stroke-width:3px
    
    style Agent1 fill:#e8f5e9,stroke:#2e7d32,stroke-width:2px
    style Agent2 fill:#e8f5e9,stroke:#2e7d32,stroke-width:2px
    style Agent3 fill:#e8f5e9,stroke:#2e7d32,stroke-width:2px
    style Agent4 fill:#e8f5e9,stroke:#2e7d32,stroke-width:2px
    style Agent5 fill:#e8f5e9,stroke:#2e7d32,stroke-width:2px
    style Agent6 fill:#e8f5e9,stroke:#2e7d32,stroke-width:2px
    
    style Combine fill:#fff9c4,stroke:#fbc02d,stroke-width:2px
    style WriteFiles fill:#e1f5ff,stroke:#0288d1,stroke-width:2px
    style MemoryDecay fill:#f3e5f5,stroke:#9c27b0,stroke-width:2px
    style NewSession fill:#fff4e6,stroke:#ff9800,stroke-width:3px
    style AIReads fill:#e6ffe6,stroke:#4caf50,stroke-width:3px
    style FullContext fill:#c8e6c9,stroke:#2e7d32,stroke-width:3px
    style Seamless fill:#e6ffe6,stroke:#4caf50,stroke-width:2px
    style Benefits fill:#c8e6c9,stroke:#2e7d32,stroke-width:4px
